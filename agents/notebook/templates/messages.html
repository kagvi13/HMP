<!DOCTYPE html>
<html>
<head>
    <title>–°–æ–æ–±—â–µ–Ω–∏—è</title>
    <style>
        .message { padding: 8px; margin: 10px 0; border-radius: 8px; }
        .source-user { background-color: #e0f7fa; }
        .source-cli { background-color: #dcedc8; }
        .source-llm { background-color: #f3e5f5; }
        .source-system { background-color: #fff3e0; }
        .private::after { content: " üîí"; }
        .from-self::before { content: "üßç "; }
    </style>
</head>
<body>
    <div style="margin-bottom: 10px;">
        {% if username %}
            –ü—Ä–∏–≤–µ—Ç, {{ username }} | <a href="/logout">–í—ã—Ö–æ–¥</a>
        {% else %}
            <a href="/login">–í–æ–π—Ç–∏</a> | <a href="/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
        {% endif %}
    </div>

    <h1>–°–æ–æ–±—â–µ–Ω–∏—è</h1>

    <form method="post">
        <textarea name="text" rows="3" cols="40" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea><br>
        <button name="hidden" value="false" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        <button name="hidden" value="true" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ</button>
    </form>

    <hr>

    <div>
        <a href="/messages">üì¢ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è</a> |
        <a href="/messages?only_personal=true">üôã –¢–æ–ª—å–∫–æ –º–æ–∏</a>
    </div>

    <hr>

    {% for msg in messages %}
        <div class="message source-{{ msg.source }}">
            <div>
                {% if msg.user_did == request.session['did'] %}<span class="from-self"></span>{% endif %}
                {% if msg.hidden %}<span class="private"></span>{% endif %}
                –ò—Å—Ç–æ—á–Ω–∏–∫: <i>{{ msg.source }}</i> ‚Äî {{ msg.timestamp }}
            </div>
            <div>
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {% if msg.username %}<b>{{ msg.username }}</b>{% endif %} {% if msg.user_did !="" %}({{ msg.user_did }}){% endif %}
            </div>
            <hr>
            <div>{{ msg.text }}</div>
        </div>
    {% endfor %}
</body>
</html>
